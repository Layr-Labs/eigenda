clean:
	rm -rf ./bin

build: clean
	# cd ../.. && make protoc
	go mod tidy
	go build -o ./bin/server ./cmd

run: build
	TRAFFIC_GENERATOR_HOSTNAME=disperser-goerli.eigenda.xyz \
	TRAFFIC_GENERATOR_GRPC_PORT=443 \
	TRAFFIC_GENERATOR_TIMEOUT=10s \
	TRAFFIC_GENERATOR_NUM_INSTANCES=3 \
	TRAFFIC_GENERATOR_REQUEST_INTERVAL=1s \
	TRAFFIC_GENERATOR_DATA_SIZE=200000 \
	TRAFFIC_GENERATOR_ADV_THRESHOLD=25 \
	TRAFFIC_GENERATOR_QUORUM_THRESHOLD=50 \
	TRAFFIC_GENERATOR_RANDOMIZE_BLOBS=true \
	TRAFFIC_GENERATOR_USE_SECURE_GRPC=true \
	./bin/server
